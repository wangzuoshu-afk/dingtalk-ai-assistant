# é’‰é’‰AIåŠ©æ‰‹ (DingTalk AI Assistant)

è¿™æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„é’‰é’‰AIåŠ©æ‰‹ï¼Œé›†æˆäº†OpenAIçš„GPTå’ŒWhisperæ¨¡å‹ï¼Œæ—¨åœ¨ä¸ºæ‚¨æä¾›æ™ºèƒ½ã€é«˜æ•ˆçš„AIæœåŠ¡ã€‚æ‚¨å¯ä»¥ä¸å®ƒè¿›è¡Œæ–‡å­—æˆ–è¯­éŸ³å¯¹è¯ï¼Œè·å–æœ€æ–°çš„AIèµ„è®¯ï¼Œå¹¶æ ¹æ®éœ€è¦ç”Ÿæˆä¸“ä¸šçš„PDFæŠ¥å‘Šã€‚

## âœ¨ ä¸»è¦åŠŸèƒ½

- **ğŸ¤– æ™ºèƒ½å¯¹è¯**ï¼šåŸºäºOpenAI GPT-4-turboæ¨¡å‹ï¼Œæä¾›æµç•…ã€ä¸“ä¸šçš„AIé¢†åŸŸé—®ç­”æœåŠ¡ã€‚
- **ğŸ¤ è¯­éŸ³è¯†åˆ«**ï¼šæ”¯æŒä¸æœºå™¨äººå•èŠæ—¶å‘é€è¯­éŸ³æ¶ˆæ¯ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å°†è¯­éŸ³è½¬æ¢ä¸ºæ–‡å­—å¹¶è¿›è¡Œå›å¤ã€‚
- **ğŸ“° æ¯æ—¥AIèµ„è®¯**ï¼šæ¯å¤©æ—©ä¸Š9ç‚¹è‡ªåŠ¨å‘æŒ‡å®šé’‰é’‰ç¾¤æ¨é€æœ€æ–°çš„AIè¡Œä¸šæ–°é—»å’ŒæŠ€æœ¯åŠ¨æ€ã€‚
- **ğŸ“„ PDFæŠ¥å‘Šç”Ÿæˆ**ï¼šå½“æ‚¨éœ€è¦å¯¹æŸä¸ªAIä¸»é¢˜è¿›è¡Œæ·±å…¥äº†è§£æ—¶ï¼Œåªéœ€å‘é€â€œç”Ÿæˆå…³äº...çš„æŠ¥å‘Šâ€ï¼ŒAIåŠ©æ‰‹å³å¯ä¸ºæ‚¨ç”Ÿæˆä¸€ä»½ç»“æ„å®Œæ•´ã€å†…å®¹è¯¦å®çš„PDFæŠ¥å‘Šã€‚
- **ğŸš€ æ— æœåŠ¡å™¨éƒ¨ç½²**ï¼šæä¾›åŸºäºRailwayã€Renderç­‰äº‘å¹³å°çš„éƒ¨ç½²æ–¹æ¡ˆï¼Œæ— éœ€ç®¡ç†æœåŠ¡å™¨ï¼Œè½»æ¾ä¸Šçº¿ã€‚
- **ğŸ”’ å®‰å…¨å¯é **ï¼šä¸¥æ ¼éªŒè¯é’‰é’‰å›è°ƒè¯·æ±‚ï¼Œç¡®ä¿é€šä¿¡å®‰å…¨ï¼›æ‰€æœ‰æ•æ„Ÿé…ç½®å‡ä½¿ç”¨ç¯å¢ƒå˜é‡ç®¡ç†ã€‚

## ğŸ›ï¸ ç³»ç»Ÿæ¶æ„

æœ¬é¡¹ç›®é‡‡ç”¨åŸºäºPython Flaskçš„æ— æœåŠ¡å™¨ï¼ˆServerlessï¼‰æ¶æ„ï¼Œä¸»è¦ç”±ä»¥ä¸‹å‡ ä¸ªæ¨¡å—ç»„æˆï¼š

1.  **Flaskåº”ç”¨**ï¼šä½œä¸ºä¸»æœåŠ¡ï¼Œæ¥æ”¶å’Œå¤„ç†æ¥è‡ªé’‰é’‰çš„Webhookè¯·æ±‚ã€‚
2.  **é’‰é’‰æœºå™¨äººAPI**ï¼šå¤„ç†æ¶ˆæ¯çš„æ¥æ”¶ã€éªŒè¯ã€è§£æå’Œå›å¤ã€‚
3.  **OpenAI API**ï¼š
    -   `GPT-4-turbo`ï¼šç”¨äºæ™ºèƒ½å¯¹è¯å’ŒæŠ¥å‘Šå†…å®¹ç”Ÿæˆã€‚
    -   `Whisper`ï¼šç”¨äºè¯­éŸ³è½¬æ–‡å­—ã€‚
4.  **PDFç”Ÿæˆå™¨**ï¼šä½¿ç”¨`reportlab`åº“å°†Markdownæ ¼å¼çš„æŠ¥å‘Šå†…å®¹æ¸²æŸ“æˆä¸“ä¸šçš„PDFæ–‡æ¡£ã€‚
5.  **æ–°é—»API**ï¼šé€šè¿‡`NewsAPI.org`è·å–æœ€æ–°çš„AIèµ„è®¯ã€‚
6.  **å®šæ—¶ä»»åŠ¡è°ƒåº¦å™¨**ï¼šä½¿ç”¨`APScheduler`å®ç°æ¯æ—¥å®šæ—¶æ¨é€èµ„è®¯ã€‚

![ç³»ç»Ÿæ¶æ„å›¾](https://i.imgur.com/example.png)  *ï¼ˆè¿™æ˜¯ä¸€ä¸ªå ä½ç¬¦å›¾ç‰‡ï¼Œå®é™…éƒ¨ç½²åå¯æ›¿æ¢ä¸ºçœŸå®çš„æ¶æ„å›¾ï¼‰*

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

- **åç«¯æ¡†æ¶**: Flask
- **AIæ¨¡å‹**: OpenAI GPT-4-turbo, Whisper
- **æ•°æ®åº“**: æ—  (å¯¹è¯å†å²å­˜å‚¨åœ¨å†…å­˜ä¸­)
- **PDFç”Ÿæˆ**: ReportLab
- **éƒ¨ç½²å¹³å°**: Railway, Render, Vercel, æˆ–ä»»ä½•æ”¯æŒPythonçš„PaaSå¹³å°
- **ä¾èµ–ç®¡ç†**: pip

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å‡†å¤‡å·¥ä½œ

åœ¨å¼€å§‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿æ‚¨å·²å‡†å¤‡å¥½ä»¥ä¸‹è´¦å·å’Œä¿¡æ¯ï¼š

- **é’‰é’‰ä¼ä¸šè´¦å·**ï¼šå¹¶æ‹¥æœ‰ç®¡ç†å‘˜æƒé™ä»¥åˆ›å»ºä¼ä¸šå†…éƒ¨åº”ç”¨ã€‚
- **OpenAI API Key**ï¼šç”¨äºè°ƒç”¨GPTå’ŒWhisperæ¨¡å‹ã€‚
- **NewsAPI Key** (å¯é€‰)ï¼šç”¨äºè·å–æ–°é—»èµ„è®¯ï¼Œå¯ä»¥å…è´¹æ³¨å†Œã€‚
- **GitHubè´¦å·**ï¼šç”¨äºä»£ç æ‰˜ç®¡å’Œäº‘å¹³å°éƒ¨ç½²ã€‚
- **Railwayæˆ–Renderè´¦å·**ï¼šç”¨äºéƒ¨ç½²åº”ç”¨ã€‚

### 2. åˆ›å»ºé’‰é’‰æœºå™¨äºº

1.  ç™»å½•[é’‰é’‰å¼€å‘è€…åå°](https://open-dev.dingtalk.com/)ã€‚
2.  è¿›å…¥â€œåº”ç”¨å¼€å‘â€ -> â€œä¼ä¸šå†…éƒ¨å¼€å‘â€ï¼Œç‚¹å‡»â€œåˆ›å»ºåº”ç”¨â€ã€‚
3.  å¡«å†™åº”ç”¨åŸºæœ¬ä¿¡æ¯ï¼ˆåç§°ã€æè¿°ã€å›¾æ ‡ï¼‰ï¼Œåˆ›å»ºåº”ç”¨ã€‚
4.  åœ¨åº”ç”¨è¯¦æƒ…é¡µï¼Œç‚¹å‡»â€œæ·»åŠ åº”ç”¨èƒ½åŠ›â€ï¼Œé€‰æ‹©â€œæœºå™¨äººâ€ï¼Œå¹¶ç‚¹å‡»â€œæ·»åŠ â€ã€‚
5.  é…ç½®æœºå™¨äººä¿¡æ¯ï¼š
    -   **æœºå™¨äººåç§°**ï¼šä¾‹å¦‚â€œAIå°åŠ©æ‰‹â€ã€‚
    -   **æ¶ˆæ¯æ¥æ”¶æ¨¡å¼**ï¼šé€‰æ‹©â€œHTTPæ¨é€â€ã€‚
    -   **æ¶ˆæ¯æ¥æ”¶åœ°å€**ï¼šæš‚æ—¶ç•™ç©ºï¼Œéƒ¨ç½²åº”ç”¨åä¼šå¾—åˆ°ä¸€ä¸ªå…¬ç½‘URLï¼Œå†å›æ¥å¡«å†™ã€‚
    -   **å‘å¸ƒ**ï¼šå®Œæˆé…ç½®åï¼Œç‚¹å‡»â€œå‘å¸ƒâ€æŒ‰é’®ã€‚
6.  åœ¨â€œæƒé™ç®¡ç†â€é¡µé¢ï¼Œæœç´¢å¹¶æ·»åŠ ä»¥ä¸‹æƒé™ï¼š
    -   `æœºå™¨äºº` -> `å‘é€æ¶ˆæ¯`
    -   `æœºå™¨äºº` -> `æ¥æ”¶æ¶ˆæ¯`
    -   `æ–‡ä»¶ç®¡ç†` -> `è¯»æƒé™` (å¦‚æœéœ€è¦å¤„ç†æ–‡ä»¶)
7.  åœ¨â€œç‰ˆæœ¬ç®¡ç†ä¸å‘å¸ƒâ€é¡µé¢ï¼Œå‘å¸ƒæ‚¨çš„åº”ç”¨ã€‚
8.  è·å–**AppKey**å’Œ**AppSecret**ï¼Œè¿™ä¸¤ä¸ªå€¼å°†ç”¨äºåç»­é…ç½®ã€‚

### 3. éƒ¨ç½²åº”ç”¨

æˆ‘ä»¬æ¨èä½¿ç”¨Railwayå¹³å°è¿›è¡Œéƒ¨ç½²ï¼Œå› ä¸ºå®ƒæä¾›äº†æ…·æ…¨çš„å…è´¹é¢åº¦å’Œæç®€çš„éƒ¨ç½²ä½“éªŒã€‚

1.  **Forkæœ¬é¡¹ç›®**ï¼šå°†æœ¬GitHubä»“åº“Forkåˆ°æ‚¨è‡ªå·±çš„è´¦å·ä¸‹ã€‚
2.  **ç™»å½•Railway**ï¼šä½¿ç”¨æ‚¨çš„GitHubè´¦å·ç™»å½•[Railway](https://railway.app/)ã€‚
3.  **åˆ›å»ºæ–°é¡¹ç›®**ï¼šç‚¹å‡»â€œNew Projectâ€ï¼Œé€‰æ‹©â€œDeploy from GitHub repoâ€ï¼Œç„¶åé€‰æ‹©æ‚¨åˆšåˆšForkçš„ä»“åº“ã€‚
4.  **é…ç½®ç¯å¢ƒå˜é‡**ï¼š
    -   Railwayä¼šè‡ªåŠ¨æ£€æµ‹åˆ°`requirements.txt`å¹¶å®‰è£…ä¾èµ–ã€‚
    -   è¿›å…¥é¡¹ç›®è®¾ç½®çš„â€œVariablesâ€é€‰é¡¹å¡ï¼Œæ·»åŠ ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼ˆå‚è€ƒ`.env.example`æ–‡ä»¶ï¼‰ï¼š
        -   `OPENAI_API_KEY`: æ‚¨çš„OpenAI APIå¯†é’¥ã€‚
        -   `DINGTALK_APP_KEY`: æ‚¨çš„é’‰é’‰åº”ç”¨AppKeyã€‚
        -   `DINGTALK_APP_SECRET`: æ‚¨çš„é’‰é’‰åº”ç”¨AppSecretã€‚
        -   `DINGTALK_WEBHOOK_URL`: (å¯é€‰) ç”¨äºä¸»åŠ¨æ¨é€æ¶ˆæ¯çš„Webhookåœ°å€ã€‚
        -   `NEWS_API_KEY`: (å¯é€‰) æ‚¨çš„NewsAPIå¯†é’¥ã€‚
        -   `SECRET_KEY`: ç”¨äºFlask SessionåŠ å¯†ï¼Œå¯ä»¥è®¾ç½®ä¸€ä¸ªéšæœºå­—ç¬¦ä¸²ã€‚
        -   `TZ`: è®¾ç½®æ—¶åŒºï¼Œä¾‹å¦‚ `Asia/Shanghai`ã€‚
5.  **è·å–å…¬ç½‘URL**ï¼šéƒ¨ç½²æˆåŠŸåï¼ŒRailwayä¼šä¸ºæ‚¨ç”Ÿæˆä¸€ä¸ªå…¬ç½‘URLï¼ˆä¾‹å¦‚ `https://your-project-name.up.railway.app`ï¼‰ã€‚

### 4. æ›´æ–°é’‰é’‰æœºå™¨äººé…ç½®

1.  å›åˆ°é’‰é’‰å¼€å‘è€…åå°ï¼Œæ‰¾åˆ°æ‚¨åˆ›å»ºçš„æœºå™¨äººã€‚
2.  å°†Railwayæä¾›çš„å…¬ç½‘URLåé¢åŠ ä¸Š`/webhook`ï¼ˆä¾‹å¦‚ `https://your-project-name.up.railway.app/webhook`ï¼‰ï¼Œå¡«å†™åˆ°æœºå™¨äººçš„â€œæ¶ˆæ¯æ¥æ”¶åœ°å€â€ä¸­ã€‚
3.  ä¿å­˜å¹¶é‡æ–°å‘å¸ƒæœºå™¨äººã€‚

### 5. å°†æœºå™¨äººæ·»åŠ åˆ°ç¾¤èŠ

1.  åœ¨é’‰é’‰å®¢æˆ·ç«¯ä¸­ï¼Œåˆ›å»ºä¸€ä¸ªç¾¤èŠç”¨äºæµ‹è¯•ã€‚
2.  è¿›å…¥ç¾¤è®¾ç½® -> æ™ºèƒ½ç¾¤åŠ©æ‰‹ -> æ·»åŠ æœºå™¨äºº -> é€‰æ‹©æ‚¨åˆ›å»ºçš„AIåŠ©æ‰‹ã€‚
3.  ç°åœ¨ï¼Œæ‚¨å¯ä»¥åœ¨ç¾¤é‡Œ@æœºå™¨äººè¿›è¡Œå¯¹è¯ï¼Œæˆ–è€…ä¸å®ƒè¿›è¡Œå•èŠã€‚

## âš™ï¸ æœ¬åœ°å¼€å‘

1.  å…‹éš†æ‚¨çš„ä»“åº“åˆ°æœ¬åœ°ï¼š
    ```bash
    git clone https://github.com/your-username/dingtalk-ai-assistant.git
    cd dingtalk-ai-assistant
    ```

2.  åˆ›å»ºå¹¶æ¿€æ´»è™šæ‹Ÿç¯å¢ƒï¼š
    ```bash
    python -m venv venv
    source venv/bin/activate  # Windows: venv\Scripts\activate
    ```

3.  å®‰è£…ä¾èµ–ï¼š
    ```bash
    pip install -r requirements.txt
    ```

4.  åˆ›å»º`.env`æ–‡ä»¶ï¼Œå¹¶å¡«å…¥æ‚¨çš„é…ç½®ä¿¡æ¯ï¼ˆå‚è€ƒ`.env.example`ï¼‰ã€‚

5.  ä½¿ç”¨`ngrok`ç­‰å†…ç½‘ç©¿é€å·¥å…·å°†æ‚¨çš„æœ¬åœ°æœåŠ¡æš´éœ²åˆ°å…¬ç½‘ï¼š
    ```bash
    ngrok http 5000
    ```

6.  å°†ngrokæä¾›çš„HTTPSåœ°å€ï¼ˆä¾‹å¦‚ `https://xxxx-xx-xx.ngrok.io`ï¼‰é…ç½®åˆ°é’‰é’‰æœºå™¨äººçš„å›è°ƒåœ°å€ä¸­ã€‚

7.  è¿è¡ŒFlaskåº”ç”¨ï¼š
    ```bash
    python app/app.py
    ```

## ğŸ“‚ é¡¹ç›®ç»“æ„

```
/dingtalk-ai-assistant
â”œâ”€â”€ app/                    # Flaskåº”ç”¨æ ¸å¿ƒä»£ç 
â”‚   â”œâ”€â”€ app.py              # ä¸»åº”ç”¨ï¼Œå¤„ç†Webhook
â”‚   â””â”€â”€ scheduler.py        # å®šæ—¶ä»»åŠ¡è°ƒåº¦å™¨
â”œâ”€â”€ config/                 # é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ config.py           # ç³»ç»Ÿé…ç½®
â”œâ”€â”€ utils/                  # å·¥å…·ç±»
â”‚   â”œâ”€â”€ dingtalk_utils.py   # é’‰é’‰APIå·¥å…·
â”‚   â”œâ”€â”€ openai_utils.py     # OpenAI APIå·¥å…·
â”‚   â”œâ”€â”€ pdf_utils.py        # PDFç”Ÿæˆå·¥å…·
â”‚   â””â”€â”€ news_utils.py       # æ–°é—»è·å–å·¥å…·
â”‚   â””â”€â”€ audio_utils.py      # è¯­éŸ³å¤„ç†å·¥å…·
â”œâ”€â”€ templates/              # (å¯é€‰) HTMLæ¨¡æ¿
â”œâ”€â”€ requirements.txt        # Pythonä¾èµ–
â”œâ”€â”€ .env.example            # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”œâ”€â”€ Procfile                # Gunicorné…ç½®æ–‡ä»¶
â””â”€â”€ README.md               # é¡¹ç›®è¯´æ˜
```

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤Pull Requestæˆ–Issueæ¥æ”¹è¿›è¿™ä¸ªé¡¹ç›®ã€‚æ— è®ºæ˜¯åŠŸèƒ½å¢å¼ºã€Bugä¿®å¤è¿˜æ˜¯æ–‡æ¡£å®Œå–„ï¼Œæˆ‘ä»¬éƒ½éå¸¸æ¬¢è¿æ‚¨çš„è´¡çŒ®ï¼

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ [MIT License](LICENSE) å¼€æºè®¸å¯ã€‚
